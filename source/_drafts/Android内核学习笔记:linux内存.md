---
title: Android内核学习笔记：linux内存
categories: Android内核
tags: [linux]
---

# 简介

内存是计算机最重要的资源之一，现在的物理内存越来越大，速度越来越快，价格也越来越便宜，但还是无法满足软件的内存需要，所以操作系统会采用各种方式来有效的管理有限的内存。

# 进程的理解

进程是操作系统占用资源的最小单位，如内存，CPU，IO资源等等。进程之间的内存是完全独立的，在Android系统里，每个进程里都有一个虚拟机，都有其独立的堆，栈，方法区，常量区。所以两个进程之间，是无法通过static变量来共享数据的。进程里的线程可以共享进程所拥有的内存

进程=程序+数据+PCB(进程控制块)

1. 程序就是流程，即常说的算法
2. 数据包括输入，运行期间的临时数据
3. PCB进程控制块，进程要受系统的控制，用于进程切换，中断等等操作

# 早期没有内存抽象的方式

没有内存抽象时，程序可以直接访问和操作的都是物理内存，如执行如下指令：
```
mov reg1, 1000  // 将物理地址1000中的值赋值给寄存器
```

同有内存抽象时，其内存的使用情况，如下图所示：
> ![](/img_markdown/21.png)
> 第一种情况操作系统存于RAM中，放在内存的低地址，第二种情况操作系统存在于ROM中，存在内存的高地址，一般老式的手机操作系统是这么设计的。

这种内存使用方案，会带来如下问题：

1. 无法同时运行多进程，即使内存足够大的情况下，也无法同时运行多进程，因为进程使用内存都是从物理内存的0开始使用而且是连续使用内存，这就是导致无法同时运行多个进程的根本原因
2. 当物理内存比较小时，一些使用内存比较大的程序会无法运行

这种内存使用的情况下，想同时运行多进程的唯一方案是：和硬盘做交换，当一个进程运行到一定程度时，整个存入到硬盘里，转而去执行其它进程，到需求执行这个进程时，再从硬盘中取回内存，只要同一时间内存中只有一个进程就行，这就是交换(Swapping)技术。

所以，通常来说，这种内存操作往往只存在于一些洗衣机，微波炉的芯片中，因为不可能有第二个进程去征用内存。

# 内存抽象

# 参考

1. [浅谈操作系统对内存的管理](http://www.cnblogs.com/CareySon/archive/2012/04/25/2470063.html)

